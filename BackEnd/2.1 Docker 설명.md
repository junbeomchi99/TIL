# Docker (컨테이너, 이미지) 개념 설명
// https://subicura.com/2017/01/19/docker-guide-for-beginners-1.html

도커 = 컨테이너 기반의 오픈소스 가상화 플랫폼?
다양한 프로그램, 실행환경을 컨테이너로 추상화, 동일한 인터페이스를 제공하여 프로그램의 배포 및 관리를 단순하게 해줌
- 백엔드 프로그램, db server, message que등 어떤 프로그램도 컨테이너로 추상화 가능
- 조리PC, AWS, Azure, Google cloud등 어디에서든 실행 가능

컨테이너 
![](2022-07-19-17-25-15.png)
- = 격리된 공간에서 프로세스가 동작하는 기술
- 기존 VM/가상화 방식은 OS를 가상화함 (호스트 OS e.g. windows위에 게스트 OS전체를 가상화하여 사용하는 방식)
- = 여러가지 OS를 가상화 (리눅스에서 윈도우를 돌린다던가) 할 수 있고, 비교적 사용법이 간단 but 무겁고 느려서 OS에서 사용할수 없음

이미지 
![](2022-07-19-17-24-51.png)
- =컨테이너 실행에 필요한 파일과 설정값등을 포함하고 있는것
- =상태값을 가지지 않고 변하지 않음 (Immutable)
- 컨테이너 = 이미지를 실행한 상태, 추가되거나 변하는 값은 컨테이너에 저장됨
    - 같은 이미지에서 여러개의 컨테이너를 생성 할 수 있음
    - 컨테이너의 상태가 바뀌거나 컨테이너가 삭제되더라도 이미지는 변하지않고 그대로 남아 있음
- e.g. MySQL 이미지는 debian 기반으로 MySQ을 실행하는데 필요한 파일, 실행 명령어, 포트 정보등을 가지고 있음
- =이미지는 컨테이너 실행을 위한 "모든"정보를 가지고 있기 때문에 추가적으로 의존성 파일 컴파일 및 이것저것 설치할 필요 없음
- 새로운 서버 추가시, 미리 만들어 놓은 이미지를 다운받고 컨에티너를 생성만 하면 됨
- 한 서버에 여러개의 컨테이너를 실행할 수 있고, 몇천대의 서버도 문제없음

레이어 저장방식
- =이미지는 여러개의 읽기 전용 레이어로 구성되고, 파일이 추가되거나 수정되면 새로운 레이어가 생성 됨
- A + B + C + nginx + source라는 레이거아 있으면, webapp 소스 수정을 위해 A,B,C,ngix를 제외한 새로운 source(v2) 레이어만 다운 받으면됨
- = 효율적인 이미지 관리 
- 컨테이너 생성시에도 layer 방식 사용 = 기존 이미지 레이어 위에 읽기/쓰기 레이어 추가하는 방식
- =여러개의 컨테이너를 생성해도 최소한의 용량만 사용

이미지 경로
- 이미지는 url 방식으로 관리하며, 태그를 붙일수 있음
- e.g. ubuntu 1404 이미지 -> docker/io/library/ubuntu:14.04 이며, 앞에 생략하고 ubuntu:10.04로 사용 가능

Command와 API
- 도커 클라이언트와 커맨드 명령어는 정말 잘 만들어져있음, 직관적이고 사용하기 쉬움 
- http 기반 또한 REST API 지원, 확장성 좋음