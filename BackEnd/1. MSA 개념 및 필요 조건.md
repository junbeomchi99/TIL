// 참고 블로그: https://gre-eny.tistory.com/263?category=982383
# MSA 개념 및 필요 조건 (Microservice Architecture)

## Monolith vs Microservice
- ### Monolith: 클라이언트 <-> 서버 <-> 데이터베이스
    - 작은 변화여도 새로운 버전으로 전체 빌드해서 배포해야됨 (일체식 어플리케이션은 단일 프로세스에서 실행)
    - = 확장 필요한 경우, 특정 기능만 확장 X, 전체 어플리케이션 동시 확장
    - <b>Scale Up</b> 필요 (하나의 서버의 성능을 높임 e.g. CPU, RAM 추가)
    ![](2022-07-19-15-06-30.png)
- ### Microservice: 

    클라이언트

        -> 서비스 A <-> 저장소 A

        -> 서비스 B <-> 저장소 B

        -> 서비스 C <-> 저장소 C
    - <b>scale out</b> 가능 (서버 여러대를 추가하여 서비스 확장)
    - 서버가 여러가지 조각으로 구성되어 각 서비스가 별개의 인스턴스로 로딩됨
        
        = 여러 서비스 인스턴스가 모여 하나의 비즈니스 애플리케이션 구성
        
        = 각기 저장소가 달라 업무 단위로 모듈 경계 명확
    - 기능별 독립적 확장, 서비스별 빌드 및 배포 가능, 각 서비스 독립적
    
        = 서로 다른 언어로 개발 가능

        = Polyglot (폴리글랏) = 언어나 저장소를 자율적으로 선택하는 방식
    ![](2022-07-19-15-06-56.png)

## SOA (Service Oritened Architecture)와 마이크로서비스
- side note: 소프트웨어 모듈화 (Modularity) 개념의 발전 흐름

    1. Structured/구조적 방법론 (단순히 기능을 하향식으로 분해 후 설꼐)
    2. Object-Oriented/객체지향 (객채 단위로 모듈화 하기 위한)
    3. CBD(Component based Development) (모듈화의 단위가 기능별로 재사용 할수 있는 더 큰 컴포넌트)
    4. SOA (Service Oriented Architecture) (컴포넌트를 모아 비즈니스적으로 의미 있고 완결적인 서비스 단위로 모듈화)

- SOA vs MSA
    - MSA에서는 SOA에 없던 다음 두가지 개념으로 모듈화 강화 및 진정으로 실현
        1. 서비스별 저장소 캡슐화 (= 서비스별 저장소를 분리하여 다른 서비스가 저장소를 직접 호출 하지 못함, 다른 서비스의 저장소에 접근하는 수단은 API 밖에없음)
        - SOA는 서비스는 분리되어있지만, 같은 저장소를 사용
        2. REST API 같은 개방형 표준 사용, 각 서비스가 느슨하게 연계되고 누구나 쉽게 사용 사능 
        - SOA에 사용되는 SOAP 프로토콜 & XML 보다 HTTP 프로토콜과 JSON 데이터의 형태가 단순하고 쉬움

## Microservice 정의(Martin Fowler)
- 여러개의 작은 서비스 집합으로 개발하는 접근 방법
- 각 서비스는 개별 프로세스에서 실행
- HTTP 자원 API 같은 가벼운 수단을 사용해서 통신
- 서비스 비즈니스 기능 단위로 구성
- 자동화된 배포 방식 이용, 독립적으로 배포
- 서비스에 대한 중앙 집중적인 관리 최소화
- 각 서비스는 서로 다른 언어와 데이터,저장 기술 사용 가능

![](2022-07-19-15-37-21.png)

## Microservce 조건
- 개발환경, 문화, 일하는 방식이 뒷받침 되어야됨

### Microservice 조건 1) 조직의 변화: 업무 기능 중심 팀
- Conway's Law = 시스템을 개발할 떄 항상 시스템의 모양이 팀의 의사소통 구조를 반영
- 예전 방식
    ![](2022-07-19-15-39-17.png)
- #### 업무 기능 중심 팀 
    - 역활/기술별 팀 분리가 아닌, 업무 기능을중심으로 기수로가 역활이 다양한 사람이 하나의 팀이 되어 서비스를 만드는 것
    - = 같은 공간/시간 공유하여 빠르고 원할한 의사결정
    - = Cross-functional Team (담당 비즈니스 관련 서비스 만들뿐만이 아니라 개발 이후 운영할 책임까지 가져감) 
    ![](2022-07-19-15-39-45.png)
    - cross-functional 팀은 필요 기능과 기술이 팀내에 전부 있어, 다른팀과 협력이 적음 = 서로 느슨하게 연계됨
![](2022-07-19-15-41-46.png)

### Microservice 조건 2) 관리체계의 변화: 자율적인 분권 거버넌스, 폴리글랏(Polyglot)
- Polyglot Programming/ Polygram 저장소 
- = 빠르게 서비스를 만드는것을 최우선 -> 효율적인 방법론과 도구, 기술을 찾아 -> 각 서비스 팀에 맞는 개발 언어 및 저장소를 선택
![](2022-07-19-15-43-38.png)

### Microservice 조건 3) 개발 생명주기의 변화: 프로젝트가 아니라 제품 중심으로
- agile 개발 방식 채용 (2~3주 단위 sprint를 통한 SW 개발 및 배포 -> 피드백 -> SW 반영)
- =한시적 프로젝트가 아닌 지속적으로 개선시키고 발전시킬 제품으로 바라봄
![](2022-07-19-15-45-18.png)

### Microservice 조건 4) 개발 환경의 변화: 인프라 자동화

전체 소프트웨어 구현 과정
1. 개발 환경 준비 (인프라)
2. 개발 (분석/설계/개발)
3. 개발지원과정 (빌드/테스트/배포)

- 개발 환경 준비를 cloud infra를 활용하여 쉽고 빠르게 + 개발지원과정 자동화
- = 개발과 운영 동시 수행, DevOps 가능하게함
- 개발 환경/ 개발지원 환경 자동화 = 인프라 자동화라고 칭함
![](2022-07-19-15-48-58.png)

- IoC (Infrastructure as Code)
    - 인프라 구성 + 자동화를 코드로 처리하는 방식
    - ㅋ코드로 인프라 구성, 앱 빌드, 배포를 정의 
    - 수많은 하드웨어 리소스 설정 동일하게 통제
    - 상황에 따른 검증 + 적절한 설정을 쉽게 복제 및 공유

### Microservice 조건 5) 통합 저장소가 아닌 분권 데이터 관리
- Polyplot persistence (폴리그랏 저장소) 접근법 = 서비스별로 데이터베이스 갖도록 설계
- 각 저장소가 서비스로 분산, 다른 서비스의 저장소를 직접 호출할 수 없고 API를 통해서만 접근 가능케 함

# Summary (TLDR;)

MSA 지향하려면 클라우드 환경에서 비즈니스 민첩성 강화를 위해 3가지가 필요
1. 기술 = 자동화된 개발 환경 기반의 microservice architecture
2. 업무방식 = 점진 반복적인 개박 프로세스
3. 조직문화 = 자율적인 업무 기능 중심 팀과 자율적인 개발 문화
![](2022-07-19-15-54-03.png)